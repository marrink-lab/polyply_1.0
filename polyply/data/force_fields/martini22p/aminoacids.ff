[ macros ]
protein_resnames "GLY|ALA|CYS|VAL|LEU|ILE|MET|PRO|HYP|ASN|GLN|ASP|ASP0|GLU|GLU0|THR|SER|LYS|LYS0|ARG|ARG0|HIS|HISH|PHE|TYR|TRP"
protein_resnames_non_pro "GLY|ALA|CYS|VAL|LEU|ILE|MET|ASN|GLN|ASP|ASP0|GLU|GLU0|THR|SER|LYS|LYS0|ARG|ARG0|HIS|HISH|PHE|TYR|TRP"

;;; GLYCINE

[ moleculetype ]
; molname       nrexcl
GLY                1			

[ atoms ]
;id type resnr residu atom cgnr   charge
 1   P5   1     GLY    BB     1      0      


;;; ALANINE

[ moleculetype ]
; molname       nrexcl
ALA                1

[ atoms ]
;id type resnr residu atom cgnr   charge
 1   P4    1     ALA    BB     1      0     ; ALA slightly less polar 


;;; CYSTEINE

[ moleculetype ]
; molname       nrexcl
CYS                1

[ atoms ]
;id type resnr residu atom cgnr   charge
 1   P5     1   CYS    BB     1      0
 2   C5     1   CYS    SC1    2      0     

[bonds]
#meta {"group": "Side chain bonds"}
;  i     j   funct   length  force.c.
   1     2    1       0.31     7500        


;;; VALINE

[ moleculetype ]
; molname       nrexcl
VAL                1

[ atoms ]
;id type resnr residu atom cgnr   charge
 1   P5   1     VAL     BB     1      0    
 2   C2   1     VAL     SC1    2      0    

[constraints]
;  i     j   funct   length  
   1     2    1       0.265       


;;; LEUCINE

[ moleculetype ]
; molname       nrexcl
LEU                1

[ atoms ]
;id type resnr residu atom cgnr   charge
 1   P5   1     LEU     BB     1      0    
 2   C1   1     LEU     SC1    2      0    

[bonds]
#meta {"group": "Side chain bonds"}
;  i     j   funct   length  force.c.
   1     2    1       0.33     7500    


;;; ISOLEUCINE

[ moleculetype ]
; molname       nrexcl
ILE                1

[ atoms ]
;id type resnr residu atom cgnr   charge
 1   P5   1     ILE     BB     1      0    
 2   C1   1     ILE     SC1    2      0    

[constraints]
;  i     j   funct   length  
   1     2    1       0.31       


;;; METHIONINE

[ moleculetype ]
; molname       nrexcl
MET                1

[ atoms ]
;id type resnr residu atom cgnr   charge
 1   P5   1     MET     BB     1      0    
 2   C5   1     MET     SC1    2      0     

[bonds]
#meta {"group": "Side chain bonds"}
;  i     j   funct   length  force.c.
   1     2    1       0.40     2500


;;; PROLINE

[ moleculetype ]
; molname       nrexcl
PRO                1

[ atoms ]
;id type resnr residu atom cgnr   charge
 1   P4   1     PRO     BB     1      0    
 2   C3   1     PRO     SC1    2      0    

[bonds]
#meta {"group": "Side chain bonds"}
;  i     j   funct   length  force.c.
  1     2    1       0.30     7500


;;; ASPARAGINE

[ moleculetype ]
; molname       nrexcl
ASN                1

[ atoms ]
;id type resnr residu atom cgnr   charge  mass
 1   P5    1     ASN     BB     1      0  72
 2   Nda   1     ASN     SC1    2      0   0
 3   D     1     ASN     SCP    3  +0.46  36 {"charge_dummy": 0.14}
 4   D     1     ASN     SCN    4  -0.46  36 {"charge_dummy": 0.14}

[virtual_sites2]
; Site from       funct a
   2     3    4   1     0.5

[ edges ]
SCP SC1
SCN SC1 

[bonds]
#meta {"group": "Side chain bonds"}
;  i     j   funct   length  force.c.
   1     2    1       0.32     5000

[constraints]
;  i     j   funct   length 
   3     4    1       0.28   

;;; GLUTAMINE

[ moleculetype ]
; molname       nrexcl
GLN                1

[ atoms ]
;id type resnr residu atom cgnr   charge  mass
 1   P5    1     GLN     BB     1      0  72
 2   Nda   1     GLN     SC1    2      0   0
 3   D     1     GLN     SCP    3  +0.42  36 {"charge_dummy": 0.14}
 4   D     1     GLN     SCN    4  -0.42  36 {"charge_dummy": 0.14}

[virtual_sites2]
; Site from       funct a
   2     3    4   1     0.5

[ edges ]
SCP SC1
SCN SC1 

[bonds]
#meta {"group": "Side chain bonds"}
;  i     j   funct   length  force.c.
   1     2    1       0.40     5000     

[constraints]
;  i     j   funct   length 
   3     4    1       0.28   

;;; ASPARTATE

[ moleculetype ]
; molname       nrexcl
ASP                1

[ atoms ]
;id type resnr residu atom cgnr   charge  mass
 1   P5     1     ASP     BB     1     0  72
 2   Qa     1     ASP     SC1    2     0  36
 3   D      1     ASP     SCN    3  -1.0  36 {"charge_dummy": 0.11}

[bonds]
#meta {"group": "Side chain bonds"}
;  i     j   funct   length  force.c.
   1     2    1       0.32     7500

[constraints]
;  i     j   funct   length 
   2     3    1       0.11   

;;; ASPARTATE - NEUTRAL FORM

[ moleculetype ]
; molname       nrexcl
ASP0               1

[ atoms ]
;id type resnr residu atom cgnr   charge
 1   P5     1     ASP0    BB     1      0    
 2   P3     1     ASP0    SC1    2      0    

[bonds]
#meta {"group": "Side chain bonds"}
;  i     j   funct   length  force.c.
   1     2    1       0.32     7500


;;; GLUTAMATE

[ moleculetype ]
; molname       nrexcl
GLU                1

[ atoms ]
;id type resnr residu atom cgnr   charge mass
 1   P5     1     GLU     BB     1     0 72
 2   Qa     1     GLU     SC1    2     0 36 
 3   D      1     GLU     SCN    3  -1.0 36  {"charge_dummy": 0.11}

[bonds]
#meta {"group": "Side chain bonds"}
;  i     j   funct   length  force.c.
   1     2    1       0.40     5000     

[constraints]
;  i     j   funct   length 
   2     3    1       0.11   


;;; GLUTAMATE - NEUTRAl FORM

[ moleculetype ]
; molname       nrexcl
GLU0               1

[ atoms ]
;id type resnr residu atom cgnr   charge
 1   P5     1     GLU0    BB     1      0    
 2   P1     1     GLU0    SC1    2      0    

[bonds]
#meta {"group": "Side chain bonds"}
;  i     j   funct   length  force.c.
   1     2    1       0.40     5000    

;;; THREONINE

[ moleculetype ]
; molname       nrexcl
THR                1

[ atoms ]
;id type resnr residu atom cgnr   charge
1   P5     1     THR     BB     1      0    72
2   N0     1     THR     SC1    2      0    0
3   D      1     THR     SCP    3  +0.36    36 {"charge_dummy": 0.14}
4   D      1     THR     SCN    4  -0.36    36 {"charge_dummy": 0.14}

[virtual_sites2]
; Site from       funct a
   2     3    4   1     0.5

[ edges ]
SCP SC1
SCN SC1 

[ bonds ]
#meta {"group": "Side chain bonds"}
;  i     j   funct   length force.c.
   1     2    1       0.26  9000

[constraints]
;  i     j   funct   length 
   3     4    1       0.28   

;;; SERINE

[ moleculetype ]
; molname       nrexcl
SER                1

[ atoms ]
;id type resnr residu atom cgnr   charge  mass
1   P5     1    SER     BB     1      0   72
2   N0     1    SER     SC1    2      0    0
3   D      1    SER     SCP    3  +0.40   36 {"charge_dummy": 0.14}
4   D      1    SER     SCN    4  -0.40   36 {"charge_dummy": 0.14}

[virtual_sites2]
; Site from       funct a
   2     3    4   1     0.5

[ edges ]
SCP SC1
SCN SC1 

[bonds]
#meta {"group": "Side chain bonds"}
;  i     j   funct   length  force.c.
   1     2    1       0.25     7500

[constraints]
;  i     j   funct   length 
   3     4    1       0.28   

;;; LYSINE 

[ moleculetype ]
; molname       nrexcl
LYS                1

[ atoms ]
;id type resnr residu atom cgnr   charge mass
 1   P5    1     LYS     BB     1      0 72
 2   C3    1     LYS     SC1    2      0 72 
 3   Qd    1     LYS     SC2    3      0 36
 4   D     1     LYS     SCP    4    1.0 36 {"charge_dummy": 0.11}

[bonds]
#meta {"group": "Side chain bonds"}
;  i     j   funct   length  force.c.
   1     2    1       0.33     5000      
   2     3    1       0.28     5000  

[constraints]
;  i     j   funct   length 
   3     4    1       0.11   

[angles]
#meta {"group": "Side chain angles"}
;  i     j    k     funct   angle  force.c.
    1     2    3       2   180.000    25.0      

;;; LYSINE - NEUTRAL FORM

[ moleculetype ]
; molname       nrexcl
LYS0               1

[ atoms ]
;id type resnr residu atom cgnr   charge
 1   P5    1     LYS     BB     1      0    
 2   C3    1     LYS     SC1    2      0    
 3   P1    1     LYS     SC2    3      0    

[bonds]
#meta {"group": "Side chain bonds"}
;  i     j   funct   length  force.c.
   1     2    1       0.33     5000      
   2     3    1       0.28     5000  

[angles]
#meta {"group": "Side chain angles"}
;  i     j    k     funct   angle  force.c.
    1     2    3       2   180.000    25.0      


;;; ARGININE 

[ moleculetype ]
; molname       nrexcl
ARG                1

[ atoms ]
;id type resnr residu atom cgnr   charge  mass
1   P5     1     ARG     BB     1      0  72  
2   N0     1     ARG     SC1    2      0  72
3   Qd     1     ARG     SC2    3      0  36
4   D      1     ARG     SCP    4    1.0  36 {"charge_dummy": 0.11}

[bonds]
#meta {"group": "Side chain bonds"}
;  i     j   funct   length  force.c.
   1     2    1       0.33     5000   
   2     3    1       0.34     5000  

[constraints]
;  i     j   funct   length 
   3     4    1       0.11   

[angles]
#meta {"group": "Side chain angles"}
;  i     j    k     funct   angle  force.c.
    1     2    3       2   180.000    25.0      


;; ARGININE - NEUTRAL FORM

[ moleculetype ]
; molname       nrexcl
ARG0               1

[ atoms ]
;id type resnr residu atom cgnr   charge
1   P5     1     ARG0    BB     1      0    
2   N0     1     ARG0    SC1    2      0    
3   P4     1     ARG0    SC2    3      0    

[bonds]
#meta {"group": "Side chain bonds"}
;  i     j   funct   length  force.c.
   1     2    1       0.33     5000       
   2     3    1       0.34     5000     

[angles]
#meta {"group": "Side chain angles"}
;  i     j    k     funct   angle  force.c.
    1     2    3       2   180.000    25.0      


;;; HISTIDINE 

[ moleculetype ]
;molname       nrexcl
HIS                1

[ atoms ]
;id type resnr residu atom cgnr   charge
1   P5     1     HIS     BB     1      0    
2   SC4    1     HIS     SC1    2    0    ; three side chains in triangle
3   SP1    1     HIS     SC2    3    0    ; configuration, mimicking
4   SP1    1     HIS     SC3    4    0    ; ring structure

[bonds]
#meta {"group": "Side chain bonds"}
;  i     j   funct   length  force.c.
   1     2    1       0.32     7500 

[constraints]
;  i     j   funct   length  
   2     3    1       0.27    
   2     4    1       0.27   
   3     4    1       0.27  

[angles]
#meta {"group": "Side chain angles"}
;  i     j    k     funct   angle  force.c.
    1     2    3       2   150.000   50.0  
    1     2    4       2   150.000   50.0 

[dihedrals]
;  i     j    k    l   funct   angle  force.c.
   1     3    4    2       2    0.0    50.0     ; to prevent backflipping of ring

;;; HISTIDINE, charged.

[ moleculetype ]
;molname       nrexcl
HISH               1

[ atoms ]
;id type resnr residu atom cgnr   charge
1   P5     1     HIS     BB     1    0    72
2   SC4    1     HIS     SC1    2    0    72 ; three side chains in triangle
3   SP1    1     HIS     SC2    3    0    72 ; configuration, mimicking
4   SQd    1     HIS     SC3    4    0    36 ; ring structure
5   D      1     HIS     SCP    5  1.0    36 {"charge_dummy": 0.11}

[bonds]
#meta {"group": "Side chain bonds"}
;  i     j   funct   length  force.c.
   1     2    1       0.32     7500 

[constraints]
;  i     j   funct   length  
   2     3    1       0.27    
   2     4    1       0.27   
   3     4    1       0.27  
   4     5    1       0.11  

[angles]
#meta {"group": "Side chain angles"}
;  i     j    k     funct   angle  force.c.
    1     2    3       2   150.000   50.0  
    1     2    4       2   150.000   50.0 

[dihedrals]
;  i     j    k    l   funct   angle  force.c.
   1     3    4    2       2    0.0    50.0     ; to prevent backflipping of ring


;;; PHENYLALANINE

[ moleculetype ]
; molname       nrexcl
PHE                1

[ atoms ]
;id type resnr residu atom cgnr   charge
1   P5     1     PHE     BB     1    0
2   SC5    1     PHE     SC1    2    0    ; three side chains in triangle
3   SC5    1     PHE     SC2    3    0    ; configuration, mimicking
4   SC5    1     PHE     SC3    4    0    ; ring structure

[bonds]
#meta {"group": "Side chain bonds"}
;  i     j   funct   length  force.c.
   1     2    1       0.31     7500 	

[constraints]
;  i     j   funct   length  
   2     3    1       0.27     
   2     4    1       0.27    
   3     4    1       0.27   

[angles]
#meta {"group": "Side chain angles"}
;  i     j    k     funct   angle  force.c.
    1     2    3       2   150.000   50.0  
    1     2    4       2   150.000   50.0 

[dihedrals]
;  i     j    k    l   funct   angle  force.c.
   1     3    4    2       2    0.0    50.0     ; to prevent backflipping of ring


;;; TYROSINE

[ moleculetype ]
; molname       nrexcl
TYR                1

[ atoms ]
;id type resnr residu atom cgnr   charge
1   P5     1     TYR     BB     1    0
2   SC4    1     TYR     SC1    2    0  
3   SC4    1     TYR     SC2    3    0 
4   SP1    1     TYR     SC3    4    0  

[bonds]
#meta {"group": "Side chain bonds"}
;  i     j   funct   length  force.c.
   1     2    1       0.32     5000 	

[constraints]
;  i     j   funct   length  
   2     3    1       0.27     
   2     4    1       0.27    
   3     4    1       0.27   

[angles]
#meta {"group": "Side chain angles"}
;  i     j    k     funct   angle  force.c.
    1     2    3       2   150.000   50.0  
    1     2    4       2   150.000   50.0 

[dihedrals]
;  i     j    k    l   funct   angle  force.c.
   1     3    4    2       2    0.0    50.0     ; to prevent backflipping of ring


;;; TRYPTOPHAN

[ moleculetype ]
;molname       nrexcl
TRP                1

[ atoms ]
;id type resnr residu atom cgnr   charge
1   P5       1     TRP     BB     1    0
2   SC4      1     TRP     SC1    2    0    
3   SNd      1     TRP     SC2    3    0
4   SC5      1     TRP     SC3    4    0
5   SC5      1     TRP     SC4    5    0

[bonds]
#meta {"group": "Side chain bonds"}
;  i     j   funct   length  force.c.
   1     2    1       0.30     5000 	

[constraints]
;  i     j   funct   length  
   2     3    1       0.27     
   3     4    1       0.27    
   2     4    1       0.27   
   3     5    1       0.27    
   4     5    1       0.27   

[angles]
#meta {"group": "Side chain angles"}
;  i     j    k     funct   angle  force.c.
   1     2    3       2   210.000   50.0 
   1     2    4       2   90.000    50.0  

[dihedrals]
;  i     j    k    l   funct   angle  force.c.
   1     3    4    2       2    0.0    50.0     ; to prevent backflipping of ring
   2     3    5    4       2    0.0    200.0    ; to keep plane fixed


;;; Links

;; Links for COIL. We apply them first as coil is the default.
[ link ]
resname $protein_resnames
[ bonds ]
BB +BB 1 0.350 1250 {"group": "Backbone bonds"}


[ link ]
resname $protein_resnames
[ angles ]
-BB  BB  SC1  2 100 25 {"group": "BBS angles"}

[ link ]
resname $protein_resnames
[ angles ]
#meta {"group": "First SBB"}
SC1 BB +BB 2 100 25
[ non-edges ]
BB -BB

;; Links for the different secondary structures.
;; Set the bead type as a function of the secondary structures.
;; We first replace for all amino acids, including for PRO and ALA that are
;; special.
[ link ]
resname $protein_resnames
[ atoms ]
BB {"cgsecstruct": "T|3|E", "replace": {"atype": "Nda"}}

[ link ]
resname $protein_resnames
[ atoms ]
BB {"cgsecstruct": "2", "replace": {"atype": "Na"}}

[ link ]
resname $protein_resnames
[ atoms ]
BB {"cgsecstruct": "1", "replace": {"atype": "Nd"}}

[ link ]
resname $protein_resnames
[ atoms ]
BB {"cgsecstruct": "H|F", "replace": {"atype": "N0"}}

;; Fix bead types for ALA and PRO.
[ link ]
resname "ALA|PRO|HYP"
[ atoms ]
BB {"cgsecstruct": "S", "replace": {"atype": "P4"}}

[ link ]
resname "ALA|PRO|HYP"
[ atoms ]
BB {"cgsecstruct": "T|3|2|1|E", "replace": {"atype": "N0"}}

[ link ]
resname "ALA|PRO|HYP"
[ atoms ]
BB {"cgsecstruct": "H|F", "replace": {"atype": "C5"}}

[ link ]
resname "PRO"
[ atoms ]
BB {"cgsecstruct": "2", "replace": {"atype": "Na"}}

;; Setup the bonds. We only have the bonds assuming everything is coil.
;; We always select the lowest force constant when the two residues involved
;; are assigned different secondary structures.
;; Bonds/constraints between different secondary structures have the average
;; length.
[ link ]
resname $protein_resnames
[ bonds ]
BB +BB 1 0.3375 1250
[ patterns ]
BB +BB {"cgsecstruct": "F"}
BB {"cgsecstruct": "F"} +BB
[ features ]
collagen

[ link ]
resname $protein_resnames
cgsecstruct "F"
[ bonds ]
BB +BB 1 0.365 1250
[ features ]
collagen

[ link ]
resname $protein_resnames
[ constraints ]
BB +BB 1 0.310 
[ !bonds ]
BB +BB
[ patterns ]
BB {"cgsecstruct": "H|1|2|3"} +BB
BB +BB {"cgsecstruct": "H|1|2|3"}

[ link ]
resname $protein_resnames
[ constraints ]
BB +BB 1 0.33
[ !bonds ]
BB +BB
[ patterns ]
BB {"cgsecstruct": "H|1|2|3"} +BB {"cgsecstruct": "S|C|T|E"}
BB {"cgsecstruct": "S|C|T|E"} +BB {"cgsecstruct": "H|1|2|3"}

[ link ]
resname $protein_resnames
[ constraints ]
BB +BB 1 0.3375
[ !bonds ]
BB +BB
[ patterns ]
BB {"cgsecstruct": "H|1|2|3"} +BB {"cgsecstruct": "F"}
BB {"cgsecstruct": "F"} +BB {"cgsecstruct": "H|1|2|3"}

;; Setup the angles. We only define those that are different from coil.
;; When there is more than one secondary structure involved, we take the
;; angle with the lowest force constant, then the lowest angle.
[ link ]
resname $protein_resnames
[ angles ]
-BB BB +BB 2 96 700 {"group": "BBB angles"}
[ patterns ]
-BB BB {"cgsecstruct": "H|1|2|3"} +BB 
-BB {"cgsecstruct": "H|1|2|3"} BB +BB 
-BB  BB +BB {"cgsecstruct": "H|1|2|3"}

[ link ]
resname $protein_resnames
[ angles ]
-BB BB {"cgsecstruct": "E"} +BB 2 134 25 {"group": "BBB angles"}
[ patterns ]
-BB BB {"cgsecstruct": "E"} +BB 
-BB {"cgsecstruct": "E"} BB +BB 
-BB  BB +BB {"cgsecstruct": "E"}

[ link ]
resname $protein_resnames
[ angles ]
-BB BB {"cgsecstruct": "S"} +BB 2 130 20 {"group": "BBB angles"}
[ patterns ]
-BB BB {"cgsecstruct": "S"} +BB 
-BB {"cgsecstruct": "S"} BB +BB 
-BB  BB +BB {"cgsecstruct": "S"}

[ link ]
resname $protein_resnames
[ angles ]
-BB BB {"cgsecstruct": "F"} +BB 2 119.2 150 {"group": "BBB angles"}
[ patterns ]
-BB BB {"cgsecstruct": "F"} +BB 
-BB {"cgsecstruct": "F"} BB +BB 
-BB  BB +BB {"cgsecstruct": "F"}
[ features ]
collagen

[ link ]
[ angles ]
-BB BB +BB 2 98 100 {"group": "BBB angles"}
[ patterns ]
-BB BB {"cgsecstruct": "H|1|2|3", "resname": "PRO|HYP"} +BB 
-BB {"cgsecstruct": "H|1|2|3", "resname": "PRO|HYP"} BB +BB 
-BB  BB +BB {"cgsecstruct": "H|1|2|3", "resname": "PRO|HYP"}

[ link ]
[ angles ]
-BB BB +BB 2 134 25 {"group": "BBB angles"}
[ patterns ]
-BB BB {"cgsecstruct": "E", "resname": "PRO|HYP"} +BB 
-BB {"cgsecstruct": "E", "resname": "PRO|HYP"} BB +BB 
-BB  BB +BB {"cgsecstruct": "E", "resname": "PRO|HYP"}

[ link ]
resname $protein_resnames
[ angles ]
-BB BB +BB 2 130 25 {"group": "BBB angles"}
[ patterns ]
-BB BB {"cgsecstruct": "S"} +BB 
-BB {"cgsecstruct": "S"} BB +BB 
-BB  BB +BB {"cgsecstruct": "S"}

[ link ]
resname $protein_resnames
[ angles ]
-BB BB +BB 2 127 25 {"group": "BBB angles"}
[ patterns ]
-BB BB {"cgsecstruct": "C"} +BB 
-BB {"cgsecstruct": "C"} BB +BB 
-BB  BB +BB {"cgsecstruct": "C"}
-BB {"cgsecstruct": null} BB {"cgsecstruct": null} +BB {"cgsecstruct": null}

[ link ]
resname $protein_resnames
[ angles ]
-BB BB +BB 2 100 25 {"group": "BBB angles"}
[ patterns ]
-BB BB {"cgsecstruct": "T"} +BB 
-BB {"cgsecstruct": "T"} BB +BB 
-BB  BB +BB {"cgsecstruct": "T"}


; If there is a helical proline *at the middle* of the angle, then it takes
; over.
[ link ]
[ angles ]
-BB BB {"cgsecstruct": "H|1|2|3", "resname": "PRO|HYP"} +BB 2 98 100 {"group": "BBB angles"}

;; Backbone dihedrals.
[ link ]
resname $protein_resnames
cgsecstruct "H|1|2|3"
[ dihedrals ]
-BB BB +BB ++BB 1 -120 400 1

[ link ]
resname $protein_resnames
cgsecstruct "F"
[ dihedrals ]
-BB BB  +BB ++BB 1 90.7 100 1
[ features ]
collagen

;; Local elastic network to stabilize extented regions of proteins.
[ link ]
resname $protein_resnames
cgsecstruct "E"
[ edges ]
BB +BB
+BB ++BB
++BB +++BB
[ bonds ]
BB ++BB 1 0.640 2500 {"group": "Short elastic bonds for extended regions", "edge": false}
+BB +++BB 1 0.640 2500 {"group": "Short elastic bonds for extended regions", "edge": false}
BB +++BB 1 0.970 2500 {"group": "Long elastic bonds for extended regions", "edge": false}

; Use dihedrals rather than an elastic network for extended regions of proteins.
[ link ]
resname $protein_resnames
cgsecstruct "E"
[ molmeta ]
extdih true
[ features ]
extdih
[ dihedrals ]
-BB BB +BB ++BB 1 0 10 1

[ link ]
resname $protein_resnames
cgsecstruct "E"
[ molmeta ]
extdih true
[ features ]
extdih
[ edges ]
BB +BB
+BB ++BB
++BB +++BB
[ !bonds ]
BB ++BB 1 0.640 2500
+BB +++BB 1 0.640 2500
BB +++BB 1 0.970 2500

;; Cystein bridge
[ link ]
resname "CYS"
[ constraints ]
SC1 >SC1 1 0.24 {"comment": "Disulfide bridge"}
;[ features ]
;disulfide

;; Protein terminii. These links should be applied last.
[ link ]
resname $protein_resnames
[ molmeta ]
neutral_termini not(true)
[ features ]
neutral_termini
[ atoms ]
BB {"replace": {"atype": "Qd", "charge": 1}}
[ non-edges ]
BB -BB

[ link ]
resname $protein_resnames
[ molmeta ]
neutral_termini not(true)
[ features ]
neutral_termini
[ atoms ]
BB {"replace": {"atype": "Qa", "charge": -1}}
[ non-edges ]
BB +BB

; Exclusions between the charged terminii and the charge dummies
[ link ]
resname $protein_resnames
[ exclusions ]
BB {"atype": "Qd|Qa"} *XX {"atomname": "SCP|SCN"}
